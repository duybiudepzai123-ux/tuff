<!DOCTYPE html>
<html>
<head>
    <title>PS4 Remote PKG Installer - External Links</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { font-family: 'Inter', sans-serif; text-align: center; margin: 0; background-color: #1e293b; color: #f8fafc; }
        .container { 
            max-width: 800px; 
            margin: 40px auto; 
            padding: 24px; 
            border-radius: 12px; 
            background-color: #334155; 
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.3);
        }
        .game-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-top: 24px;
        }
        .game-button {
            padding: 15px 10px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            border: none;
            border-radius: 8px;
            background-color: #3b82f6; /* Blue 500 */
            color: white;
            transition: background-color 0.2s, transform 0.1s;
            box-shadow: 0 4px #2563eb; /* Darker blue for shadow */
        }
        .game-button:hover { 
            background-color: #2563eb; /* Blue 600 */
            transform: translateY(-1px);
        }
        .game-button:active {
            transform: translateY(2px);
            box-shadow: 0 2px #1e40af; /* Even darker blue for press */
        }
        .status { margin-top: 20px; padding: 15px; border-radius: 8px; background-color: #1f2937; }
        h1 { border-bottom: 2px solid #3b82f6; padding-bottom: 10px; margin-bottom: 20px; }
        .warning { color: #fcd34d; font-weight: bold; }
    </style>
</head>
<body>

    <div class="container">
        <h1>üéÆ PS4 Remote PKG Installer (7 Games)</h1>
        <p>Vui l√≤ng ƒë·∫£m b·∫£o **GoldHEN ƒë√£ ƒë∆∞·ª£c ti√™m th√†nh c√¥ng** tr√™n PS4 tr∆∞·ªõc khi nh·∫•n n√∫t.</p>
        
        <p class="warning" id="mocking-status"></p>

        <div class="game-grid" id="game-list-container">
            <!-- C√°c n√∫t s·∫Ω ƒë∆∞·ª£c t·∫°o b·ªüi JavaScript -->
        </div>

        <div id="status-message" class="status text-lg">S·∫µn s√†ng ƒë·ªÉ g·ª≠i l·ªánh c√†i ƒë·∫∑t.</div>
    </div>

    <script>
        // =========================================================
        //                 C·∫§U H√åNH QUAN TR·ªåNG
        // =========================================================
        
        const API_PORT = 12800; 
        const PS4_IP = '127.0.0.1'; // B·∫Øt bu·ªôc ph·∫£i l√† 127.0.0.1 v√¨ l·ªánh ƒë∆∞·ª£c g·ª≠i t·ª´ tr√¨nh duy·ªát PS4
        
        // üö® CH·∫æ ƒê·ªò M√î PH·ªéNG (MOCKING) üö®
        // ƒê·∫∑t = true ƒë·ªÉ test tr√™n PC/ƒêi·ªán tho·∫°i. ƒê·∫∑t = false khi test tr√™n PS4 th·∫≠t.
        const IS_MOCKING_ENABLED = true; 
        
        // DANH S√ÅCH GAME V√Ä LINK T·∫¢I TR·ª∞C TI·∫æP (THAY ƒê·ªîI URL T·∫†I ƒê√ÇY)
        const gameList = {
            'game_a': { name: 'PES 2017 Part 1', url: 'http://gs2.ww.prod.dl.playstation.net/gs2/appkgo/prod/CUSA04984_00/4/f_c78ab470583d57fedbee36d2c70e6d8fb7889193777ef4a05b1eef11fa9b0efc/f/UP0101-CUSA04984_00-PES2017000000000_0.pkg' },
            'game_b': { name: 'PES 2017 Part 2', url: 'http://gs2.ww.prod.dl.playstation.net/gs2/appkgo/prod/CUSA04984_00/4/f_c78ab470583d57fedbee36d2c70e6d8fb7889193777ef4a05b1eef11fa9b0efc/f/UP0101-CUSA04984_00-PES2017000000000_1.pkg' },
            'game_c': { name: 'PES 2017 Part 3', url: 'http://gs2.ww.prod.dl.playstation.net/gs2/appkgo/prod/CUSA04984_00/4/f_c78ab470583d57fedbee36d2c70e6d8fb7889193777ef4a05b1eef11fa9b0efc/f/UP0101-CUSA04984_00-PES2017000000000_2.pkg' },
            'game_d': { name: 'PES 2017 Part 4', url: 'http://gs2.ww.prod.dl.playstation.net/gs2/appkgo/prod/CUSA04984_00/4/f_c78ab470583d57fedbee36d2c70e6d8fb7889193777ef4a05b1eef11fa9b0efc/f/UP0101-CUSA04984_00-PES2017000000000_3.pkg' },
            'game_e': { name: 'PES 2017 Part 5', url: 'http://gs2.ww.prod.dl.playstation.net/gs2/appkgo/prod/CUSA04984_00/4/f_c78ab470583d57fedbee36d2c70e6d8fb7889193777ef4a05b1eef11fa9b0efc/f/UP0101-CUSA04984_00-PES2017000000000_4.pkg' },
            'game_f': { name: 'Unravel Two', url: 'http://gs2.ww.prod.dl.playstation.net/gs2/appkgo/prod/CUSA10416_00/2/f_7409b329233577b3341f5ac54a317fe4ef7a9c8b7ca94bf90cb45b898b756b94/f/EP0006-CUSA10416_00-COLDWOODPIKE0000.pkg' },
            'game_g': { name: 'Minecraft Story Mode', url: 'http://gs2.ww.prod.dl.playstation.net/gs2/appkgo/prod/CUSA02463_00/2/f_5feb183cf41980e20626404beb1674e138bb53dc304aca44c5b01ac894d00537/f/EP2026-CUSA02463_00-MSM000000000GAME.pkg' },
        };
        // =========================================================
        
        // --- B∆Ø·ªöC 0: T·∫†O N√öT T·ª∞ ƒê·ªòNG ---
        function generateButtons() {
            const container = document.getElementById('game-list-container');
            for (const id in gameList) {
                const game = gameList[id];
                const button = document.createElement('button');
                button.className = 'game-button';
                button.textContent = `C√†i ${game.name}`;
                button.onclick = () => initiateInstall(id);
                container.appendChild(button);
            }
        }
        
        // Hi·ªÉn th·ªã tr·∫°ng th√°i Mocking
        if (IS_MOCKING_ENABLED) {
            document.getElementById('mocking-status').innerText = '‚ö†Ô∏è CH·∫æ ƒê·ªò MOCKING ƒêANG B·∫¨T: ƒêang gi·∫£ l·∫≠p PS4 API.';
        } else {
            document.getElementById('mocking-status').innerText = '';
        }
        
        generateButtons(); // G·ªçi h√†m t·∫°o n√∫t khi script t·∫£i xong

        // --- B∆Ø·ªöC 1: H√ÄM M√î PH·ªéNG G·ª¨I L·ªÜNH (CH·ªà CH·∫†Y KHI TEST) ---
        const originalFetch = window.fetch;

        window.fetch = function(url, options) {
            // Ch·ªâ ch·∫∑n l·ªánh g·ª≠i t·ªõi GoldHEN API
            if (IS_MOCKING_ENABLED && url.includes('127.0.0.1:12800')) {
                console.warn('MOCKING: L·ªánh g·ª≠i ƒë·∫øn GoldHEN API ƒë√£ b·ªã ch·∫∑n. Tr·∫£ v·ªÅ k·∫øt qu·∫£ th√†nh c√¥ng gi·∫£ ƒë·ªãnh.');
                
                return new Promise(resolve => {
                    setTimeout(() => {
                        const mockResponse = {
                            ok: true, 
                            status: 200,
                            text: () => Promise.resolve('{"status":"ok","message":"Command sent successfully"}'),
                        };
                        resolve(mockResponse);
                    }, 500); // Tr·ªÖ 500ms
                });
            } else {
                // N·∫øu kh√¥ng ph·∫£i l·ªánh GoldHEN, s·ª≠ d·ª•ng h√†m fetch g·ªëc
                return originalFetch(url, options);
            }
        };
        // ---------------------------------------------------------
        
        // --- B∆Ø·ªöC 2: H√ÄM CH√çNH G·ª¨I L·ªÜNH C√ÄI ƒê·∫∂T ---
        function initiateInstall(gameId) {
            const gameData = gameList[gameId];
            const PKG_URL = gameData ? gameData.url : null;
            const gameName = gameData ? gameData.name : 'Game kh√¥ng x√°c ƒë·ªãnh';
            const PS4_API_URL = `http://${PS4_IP}:${API_PORT}/api/install`;

            if (!PKG_URL) {
                document.getElementById('status-message').innerHTML = '<span style="color:red;">L·ªói: Kh√¥ng t√¨m th·∫•y ID game n√†y.</span>';
                return;
            }
            
            // S·ª≠ d·ª•ng confirm() thay cho alert() ƒë·ªÉ ƒë·∫£m b·∫£o ng∆∞·ªùi d√πng mu·ªën ti·∫øp t·ª•c
            if (!confirm(`X√°c nh·∫≠n c√†i ƒë·∫∑t game: ${gameName}? (T·∫£i qua Internet)`)) {
                return; 
            }

            document.getElementById('status-message').innerHTML = `<span style="color:#fcd34d;">ƒêang g·ª≠i l·ªánh c√†i ƒë·∫∑t ${gameName}...</span>`;

            const payloadData = { url: PKG_URL };

            fetch(PS4_API_URL, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payloadData),
            })
            .then(response => {
                if (response.ok) {
                    document.getElementById('status-message').innerHTML = 
                        `<span style="color:#10b981;">‚úÖ L·ªánh G·ª¨I th√†nh c√¥ng cho ${gameName}!</span><br>PS4 ƒëang t·∫£i Game t·ª´ **Internet**. Ki·ªÉm tra m·ª•c Notifications.`;
                } else {
                    document.getElementById('status-message').innerHTML = 
                        `<span style="color:#ef4444;">‚ùå L·ªói ${response.status}: API GoldHEN kh√¥ng ph·∫£n h·ªìi.</span><br>Vui l√≤ng ƒë·∫£m b·∫£o GoldHEN ƒë√£ ho·∫°t ƒë·ªông v√† PS4 c√≥ Internet.`;
                }
                return response.text();
            })
            .catch(error => {
                document.getElementById('status-message').innerHTML = 
                    `<span style="color:#ef4444;">‚ùå L·ªói k·∫øt n·ªëi m·∫°ng: ${error.message}</span><br>C√≥ th·ªÉ GoldHEN ch∆∞a ch·∫°y ho·∫∑c x·∫£y ra l·ªói m·∫°ng.`;
            });
        }
    </script>

</body>
</html>
